{"openapi":"3.0.0","info":{"version":"1.0.0","title":"Lydos API"},"components":{"schemas":{},"parameters":{}},"paths":{"/setting/plans":{"get":{"tags":["設定"],"summary":"プラン一覧取得","description":"利用可能なプラン一覧を取得します","responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"object","properties":{"plans":{"type":"array","items":{"type":"object","properties":{"id":{"type":"number","example":1},"name":{"type":"string","example":"無料プラン"},"description":{"type":"string","example":"基本的な機能が利用できます"},"price":{"type":"number","example":0},"isSelected":{"type":"boolean","example":false}},"required":["id","name","description","price","isSelected"]}}},"required":["plans"]}}}},"500":{"description":"予期せぬエラーが発生しました","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}}}}},"/setting/checkout-session":{"post":{"tags":["設定"],"summary":"Checkout Session作成","description":"カード登録用のCheckout Sessionを作成します。","requestBody":{"required":false,"content":{"application/json":{"schema":{"type":"object","properties":{"successUrl":{"type":"string","format":"uri","description":"決済完了後のリダイレクト先 URL"},"cancelUrl":{"type":"string","format":"uri","description":"決済キャンセル時のリダイレクト先 URL"}}}}}},"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"object","properties":{"checkoutUrl":{"type":"string","description":"Stripe Checkout Session URL"}},"required":["checkoutUrl"]}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}},"500":{"description":"予期せぬエラーが発生しました","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}}}}},"/setting/payment-methods":{"get":{"tags":["設定"],"summary":"支払い方法一覧取得","description":"登録済みの支払い方法一覧を取得します。","responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"object","properties":{"paymentMethods":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","description":"Payment Method ID"},"brand":{"type":"string","description":"Card brand (visa, mastercard, etc.)"},"last4":{"type":"string","description":"Last 4 digits of card"},"expMonth":{"type":"number","description":"Expiration month"},"expYear":{"type":"number","description":"Expiration year"},"isDefault":{"type":"boolean","description":"Whether this is the default payment method"}},"required":["id","brand","last4","expMonth","expYear","isDefault"]},"description":"List of payment methods"}},"required":["paymentMethods"]}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}},"500":{"description":"予期せぬエラーが発生しました","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}}}}},"/setting/payment-methods/{paymentMethodId}":{"delete":{"tags":["設定"],"summary":"支払い方法削除","description":"指定した支払い方法を削除します。","parameters":[{"schema":{"type":"string","description":"Stripe Payment Method ID (pm_xxx)"},"required":true,"description":"Stripe Payment Method ID (pm_xxx)","name":"paymentMethodId","in":"path"}],"responses":{"204":{"description":"No Content"},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}},"500":{"description":"予期せぬエラーが発生しました","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}}}}},"/setting/plan":{"post":{"tags":["設定"],"summary":"プラン変更","description":"支払い方法を指定してプランを変更します。","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"planId":{"type":"integer","minimum":0,"exclusiveMinimum":true,"description":"変更先プラン ID"},"paymentMethodId":{"type":"string","description":"Stripe Payment Method ID (pm_xxx)"}},"required":["planId","paymentMethodId"]}}}},"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"object","properties":{}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}},"500":{"description":"予期せぬエラーが発生しました","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}}}}},"/chat/models":{"get":{"tags":["チャット"],"summary":"AIモデル一覧取得","description":"利用可能なAIモデルの一覧を取得します","responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"object","properties":{"models":{"type":"array","items":{"type":"object","properties":{"id":{"type":"number","example":1},"name":{"type":"string","example":"Gemini 2.0 Flash"},"modelId":{"type":"string","example":"gemini-2.0-flash"},"provider":{"type":"string","example":"gemini"},"color":{"type":"string","example":"#4285F4"},"isDefault":{"type":"boolean","example":true}},"required":["id","name","modelId","provider","color","isDefault"]}}},"required":["models"]}}}},"500":{"description":"予期せぬエラーが発生しました","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}}}}},"/chat/sessions":{"get":{"tags":["チャット"],"summary":"チャットセッション一覧取得","description":"ログインユーザーのチャットセッション一覧を取得します","responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"object","properties":{"sessions":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","example":"clxxxxx"},"title":{"type":"string","example":"新しいチャット"},"modelId":{"type":"number","example":1},"modelName":{"type":"string","example":"Gemini 2.0 Flash"},"createdAt":{"type":"string","format":"date-time","example":"2026-01-01T00:00:00.000Z"},"updatedAt":{"type":"string","format":"date-time","example":"2026-01-01T00:00:00.000Z"}},"required":["id","title","modelId","modelName","createdAt","updatedAt"]}}},"required":["sessions"]}}}},"500":{"description":"予期せぬエラーが発生しました","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}}}},"post":{"tags":["チャット"],"summary":"チャットセッション作成","description":"新しいチャットセッションを作成します","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"modelId":{"type":"integer","minimum":0,"exclusiveMinimum":true,"description":"使用するAIモデルID"},"title":{"type":"string","minLength":1,"maxLength":255,"description":"セッションタイトル（省略時: \"新しいチャット\"）"}},"required":["modelId"]}}}},"responses":{"201":{"description":"Created","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string","example":"clxxxxx"}},"required":["id"]}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}},"500":{"description":"予期せぬエラーが発生しました","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}}}}},"/chat/sessions/{sessionId}/messages":{"get":{"tags":["チャット"],"summary":"メッセージ一覧取得","description":"指定セッションのメッセージ履歴を取得します","parameters":[{"schema":{"type":"string","description":"チャットセッションID"},"required":true,"description":"チャットセッションID","name":"sessionId","in":"path"}],"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"object","properties":{"messages":{"type":"array","items":{"type":"object","properties":{"id":{"type":"number","example":1},"role":{"type":"string","enum":["user","assistant"],"example":"user"},"content":{"type":"string","example":"こんにちは"},"inputTokens":{"type":"number","nullable":true,"example":10},"outputTokens":{"type":"number","nullable":true,"example":50},"createdAt":{"type":"string","format":"date-time","example":"2026-01-01T00:00:00.000Z"}},"required":["id","role","content","inputTokens","outputTokens","createdAt"]}}},"required":["messages"]}}}},"500":{"description":"予期せぬエラーが発生しました","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}}}}},"/chat/sessions/{sessionId}":{"delete":{"tags":["チャット"],"summary":"チャットセッション削除","description":"指定セッションとそのメッセージ履歴をすべて削除します","parameters":[{"schema":{"type":"string","minLength":1,"description":"チャットセッションID"},"required":true,"description":"チャットセッションID","name":"sessionId","in":"path"}],"responses":{"204":{"description":"No Content"},"500":{"description":"予期せぬエラーが発生しました","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}}}}}}}